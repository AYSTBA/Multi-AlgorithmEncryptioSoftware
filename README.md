# 多算法加密集成系统
文本、文件多算法加密集成系统
1. 设计背景与目标
随着网络攻击手段的不断演进，传统固定算法的加密系统面临逆向分析、侧信道攻击及量子计算的潜在威胁。本系统旨在构建一个动态可调、强度可扩展的混合加密平台，融合现代密码学与混沌理论，通过外部配置机制实现算法行为的灵活变更，从而极大提升攻击者逆向工程的难度。系统支持文本及任意二进制文件（图片、文档等）的加密与解密，私钥长度仅64字符，兼顾安全性与便携性。

2. 系统总体架构
系统由三个层次组成：

密钥封装层：采用椭圆曲线集成加密方案（ECIES），安全传输加密所需的混沌种子。

混沌加密层：基于种子生成高度不可预测的伪随机密钥流，并对每个字节应用多种可逆变换，配合反馈模式实现扩散。

配置管理层：通过外部JSON文件定义所有加密参数，允许动态调整算法行为而无需修改代码。

加解密双方需持有相同的配置文件，发送方使用接收方公钥加密种子，混沌引擎加密数据；接收方用私钥解密种子后逆向恢复明文。

3. 核心加密算法体系
3.1 椭圆曲线密钥封装
系统选用NIST P-256标准曲线，其安全性相当于3072位RSA。私钥为一个32字节整数（表示为64个十六进制字符），公钥为65字节未压缩格式（130字符）。密钥封装过程遵循ECIES标准：

发送方生成临时ECC密钥对，计算与接收方公钥的椭圆曲线点乘，得到共享秘密。

取共享秘密的x坐标，经HKDF-SHA256派生为AES-256密钥。

使用AES-GCM模式加密随机生成的32字节混沌种子，附加12字节随机数和16字节认证标签。

最终输出包含临时公钥、随机数、认证标签和密文的封装包（共125字节），确保种子的机密性、完整性和前向安全性。

3.2 混沌序列生成器
混沌映射对初始条件极端敏感，是生成密钥流的理想选择。系统混合两种经典映射：

Logistic映射：
x
n
+
1
=
r
x
n
(
1
−
x
n
)
x 
n+1
​
 =rx 
n
​
 (1−x 
n
​
 )，当控制参数 
r
r 接近4时处于混沌状态。

Tent映射：x
n
+
1
=
r
x
n
(
1
−
x
n
)
x 
n+1
​
 =rx 
n
​
 (1−x 
n
​
 )，参数 
μ
μ 接近2时混沌性最强。
生成过程以混沌种子和字节位置索引为输入，经SHA-512派生两个浮点数初始值，迭代映射并混合输出字节流。通过配置文件可独立调节 
r
r 和 
μ
μ 值，从而改变密钥流的统计特性，使攻击者无法预知混沌轨迹。

3.3 16种可逆字节变换
每个明文字节在加密时，根据密钥流字节选择操作类型（0至15）并获取参数（低4位），应用以下一类或多类可逆变换：

算术运算：加、减、异或、乘法（参数强制为奇数以保证可逆）。

位运算：循环左移/右移、按位取反、半字节交换（高低4位互换）。

仿射变换：
y
=
(
a
⋅
x
+
b
)
m
o
d
 
 
256
y=(a⋅x+b)mod256，其中 
a
a 为奇数（可逆）。

动态S盒：基于种子和位置生成256字节随机置换，实现非线性替代。

反馈依赖：与前一个密文字节进行加、异或或移位操作，使变换结果依赖于上下文。

乘法逆元：当明文为零时保持不变，否则乘以奇数，解密时使用预计算的逆元恢复。

这16种操作覆盖了代数、位级、查表和反馈等多种类型，确保每个字节的加密方式随机且可逆，攻击者无法通过统计规律推测变换关系。

3.4 密文反馈模式
系统采用密文反馈（CFB）模式增强扩散性：每个字节加密前，基于混沌种子和之前所有密文（取最近若干字节）生成密钥流字节，再与明文变换后的中间值异或得到最终密文。这种设计使得单个明文位的变化会迅速传播到后续所有密文，有效抵抗差分分析。初始向量由混沌种子派生并随密文存储。

4. 可配置机制设计
系统核心创新在于通过外部JSON文件动态定义算法参数，实现“算法即配置”。配置文件包含以下关键部分：

混沌参数：Logistic映射的 
r
r 值（范围3.57~4）、Tent映射的 
μ
μ 值（0~2）及哈希函数类型，直接影响密钥流复杂度。

操作集合与概率：allowed数组列出本次加密允许使用的操作编号（0-15），probabilities数组定义各操作被选中的概率（可为均匀分布或自定义），从而灵活调整加密行为的偏好。例如，可仅启用基于反馈的复杂操作（8-15），大幅提升破解难度。

模式与初始向量长度：当前支持CFB模式，IV长度可配置（默认16字节），更长IV可减少重复模式。

通过修改配置文件，用户可创造出无数种算法变体，如“全复杂操作高混沌版”、“侧重S盒版本”等，使攻击者无法预知确切变换规则。加解密双方必须使用相同配置，否则无法还原。

5. 使用流程与交互
系统提供命令行交互菜单，所有操作均通过文本框或文件路径完成：

密钥生成：生成ECC密钥对，输出私钥（64字符）和公钥（130字符）。用户需妥善保管私钥，公钥可分发。

文本加密：输入接收方公钥和明文，系统返回十六进制密文（包含ECIES封装包和混沌加密数据）。

文件加密：指定接收方公钥和文件路径，系统生成加密文件（后缀.enc）。

解密：输入私钥和密文（文本或文件路径），系统还原原始数据。

配置管理：可查看当前配置、保存到文件或从文件加载新配置，实现算法动态切换。

6. 安全性与扩展性分析
抗分析能力：混沌映射的敏感性、16种可逆变换的随机选择、CFB反馈模式以及可配置机制共同构成多重防护，使密文无统计规律，抵抗已知明文、选择明文及差分攻击。

密钥安全：ECC P-256提供强于RSA-3072的安全性，ECIES封装确保混沌种子仅私钥持有者可解密。

灵活扩展：配置文件可随时调整，若需新增操作类型，仅需扩展代码中的操作分支，现有配置机制无缝兼容。

7. 总结
本系统通过混沌理论与现代密码学的深度融合，结合动态配置机制，打造了一个高度灵活且强度可调的加密平台。用户无需编程即可定制专属算法，极大提升了数据安全性，适用于对隐私保护有极致要求的场景。

使用指南：

1. 系统简介
核心特性：

基于ECC P-256椭圆曲线，私钥仅64字符，安全且易管理。

混沌加密引擎采用Logistic与Tent映射生成密钥流，配合16种可逆字节变换及CFB反馈模式。

算法参数通过外部JSON文件配置，可随时更换算法变体。

支持文本加密（输出十六进制字符串）和文件加密（生成.enc文件）。

适用场景：个人隐私保护、敏感文件传输、安全通信等。

2. 安装与依赖
本系统为Python命令行程序，需安装Python 3.6+及pycryptodome库。

步骤1：安装Python
访问 python.org 下载并安装Python（建议3.8以上版本），安装时勾选“Add Python to PATH”。

步骤2：安装依赖库
打开终端（Windows命令提示符或PowerShell，Mac/Linux终端），运行：

bash
pip install pycryptodome
步骤3：获取程序文件
将本系统的Python源代码保存为一个文件，例如 chaos_crypto.py。您也可以从开发者处获取完整脚本。

3. 启动系统
在终端中进入程序所在目录，运行：

bash
python chaos_crypto.py
您将看到主菜单：



        可配置混沌加密系统 (当前算法: 算法名称)

请选择操作：
1. 生成ECC密钥对
2. 使用公钥加密文本
3. 使用私钥解密文本
4. 使用公钥加密文件
5. 使用私钥解密文件
6. 查看/修改算法配置
7. 退出
输入数字 (1-7):
4. 密钥管理
4.1 生成密钥对
在主菜单输入 1，按回车。

系统提示输入密钥位数（默认2048，但本系统使用ECC P-256固定，无需修改），直接回车即可。

程序将显示：

【私钥（64字符）】请妥善保管，不可泄露

abc123... (64个十六进制字符)

【公钥（130字符）】可公开

def456... (130个十六进制字符)

重要：

将私钥复制并保存在安全的地方（如密码管理器、离线存储）。丢失私钥将无法解密任何用对应公钥加密的信息！

公钥可以分享给需要给您发送加密信息的人。

4.2 分发公钥
将公钥字符串（包括所有130个字符）通过邮件、即时通讯等方式发送给对方。对方加密时需粘贴此公钥。

5. 加密操作
5.1 加密文本
在主菜单输入 2，按回车。

系统提示：“请输入对方公钥（130字符十六进制）”

粘贴接收方提供给您的公钥字符串（130个字符，可包含空格，系统会自动清理）。

系统提示：“请输入要加密的文本:”

输入您想加密的任意文本（支持中文、英文、符号、Emoji等）。

程序加密后显示：


【密文（十六进制）】

4e5f6a... (一串很长的十六进制字符串)

复制此密文字符串，发送给接收方。密文必须完整复制，包括所有字符。

5.2 加密文件（如图片、文档）
在主菜单输入 4，按回车。

系统提示：“请输入对方公钥（130字符十六进制）”

粘贴接收方的公钥。

系统提示：“请输入要加密的文件路径:”

输入文件的完整路径，例如 C:\Users\YourName\Pictures\photo.jpg 或 /home/user/docs/report.pdf。

如果文件不在当前目录，必须提供绝对路径或相对路径。

程序加密后会在同一目录下生成一个与原文件同名的 .enc 文件（例如 photo.jpg.enc）。

输出信息：加密完成，密文已保存至: 文件路径.enc

将此 .enc 文件通过任何方式发送给接收方（可附带原文件名提示）。

6. 解密操作
6.1 解密文本
在主菜单输入 3，按回车。

系统提示：“请输入您的私钥（64字符十六进制）”

粘贴您自己的私钥（之前生成并保存的64字符字符串）。

系统提示：“请输入密文（十六进制）:”

粘贴发送方给您的十六进制密文。

程序解密后显示：


【解密结果】

原始文本内容

如果解密失败，会提示错误信息（可能由于私钥不匹配、密文损坏或配置文件不一致）。

6.2 解密文件
在主菜单输入 5，按回车。

系统提示：“请输入您的私钥（64字符十六进制）”

粘贴您的私钥。

系统提示：“请输入要解密的文件路径（.enc）:”

输入接收到的 .enc 文件的完整路径，例如 C:\Users\YourName\Downloads\photo.jpg.enc。

程序解密后，会在同一目录下恢复原始文件（去掉 .enc 后缀）。例如 photo.jpg.enc 解密后生成 photo.jpg。

输出信息：解密完成，文件已保存至: 恢复的文件路径

打开恢复的文件验证完整性。

7. 配置管理（算法动态调整）
系统最强大的功能：您可以随时通过修改一个JSON文件来改变加密算法的行为，而无需重新安装或编程。加解密双方必须使用完全相同的配置文件，否则无法正确解密。

7.1 查看当前配置
在主菜单输入 6，按回车，系统将显示当前加载的算法配置（JSON格式）。例如：

json
{
    "name": "DefaultChaosV1",
    "chaos": {
        "logistic_r": 3.99,
        "tent_mu": 1.99,
        "hash_function": "sha256"
    },
    "operations": {
        "allowed": [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],
        "probabilities": null,
        "params": {
            "shift_range": [0,7],
            "mult_odd_only": true
        }
    },
    "mode": "CFB",
    "iv_size": 16
}
7.2 修改配置
您可以通过以下两种方式修改配置：

直接编辑配置文件：程序同目录下有一个 chaos_config.json 文件（若不存在，首次运行会自动创建默认配置）。用任何文本编辑器打开此文件，修改参数后保存。

通过程序菜单保存配置：在配置管理界面（输入 6 后），选择 1. 保存配置到文件，可指定文件名保存当前配置。之后可用 2. 从文件重新加载配置 加载该文件。

7.3 配置参数详解
参数	说明	建议
name	算法名称，仅用于标识	任意字符串
chaos.logistic_r	Logistic映射参数，范围 (3.57, 4)	越接近4混沌性越强，如 3.999
chaos.tent_mu	Tent映射参数，范围 (0, 2]	越接近2混沌性越强，如 1.999
chaos.hash_function	哈希函数，支持 sha256, sha512	sha512 更安全
operations.allowed	允许使用的操作编号列表（0-15）	可只保留复杂操作（8-15）提高难度
operations.probabilities	各操作被选中的概率，需与 allowed 长度相同，总和为1。若为 null 则均匀分布。	例如 [0.2,0.2,0.1,0.1,0.1,0.1,0.1,0.1]
params	预留参数，目前可忽略	-
mode	加密模式，当前仅支持 CFB	不可修改
iv_size	初始向量长度（字节）	16或32，越长越安全
7.4 示例：启用超高难度模式
将配置文件内容替换为以下JSON，可大幅提升破解难度：

json
{
    "name": "UltraHardMode",
    "chaos": {
        "logistic_r": 3.999999,
        "tent_mu": 1.999999,
        "hash_function": "sha512"
    },
    "operations": {
        "allowed": [8,9,10,11,12,13,14,15],
        "probabilities": [0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125],
        "params": {
            "shift_range": [0,7],
            "mult_odd_only": true
        }
    },
    "mode": "CFB",
    "iv_size": 32
}
保存后，在程序中选择 6 -> 2 加载此文件，之后所有加密均采用此配置。

7.5 重要提醒
配置必须一致：加密和解密时使用的配置文件必须完全相同（包括所有参数）。建议双方提前交换配置文件。

配置文件的存储：配置文件名默认为 chaos_config.json，您可以创建多个配置文件（如 config_hard.json），通过加载功能切换。

不要随意修改操作编号：操作编号对应代码中固定的16种变换，增加新的操作需要修改代码。

8. 安全注意事项
私钥绝对保密：私钥是您解密信息的唯一凭证，切勿泄露给任何人。建议使用密码管理器存储，或离线备份。

公钥可公开：公钥可以放在网站上、邮件签名中，任何人都可以用它加密发送给您。

传输安全：虽然密文本身已加密，但传输过程中仍可能被拦截。建议结合安全通道（如HTTPS、加密聊天）发送密文。

配置文件保护：配置文件定义了算法细节，虽然不是秘密（公开也能增加破解难度），但若攻击者获知配置，可能针对性分析。建议在敏感场景中，双方通过安全渠道交换配置。

定期更换密钥：长期使用同一对密钥存在风险，建议定期生成新密钥对。

9. 常见问题解答
Q：加密时提示“公钥长度应为130个十六进制字符”怎么办？
A：请检查粘贴的公钥是否完整，是否包含空格或换行。可以手动删除空格后重试。

Q：解密文本时出现“解密失败”错误，可能原因？
A：

私钥与加密时使用的公钥不匹配。

密文在复制过程中丢失了部分字符。

加密和解密时使用的配置文件不同。

密文被篡改。

Q：加密文件后，对方无法解密？
A：确保双方使用相同的配置文件，且对方使用正确的私钥。文件路径中不要有中文或特殊字符，建议使用英文路径。

Q：如何知道当前使用的算法配置？
A：在主菜单选择6，可查看当前配置的名称和参数。

Q：配置文件损坏了怎么办？
A：删除或重命名 chaos_config.json，程序下次启动会自动生成默认配置。但请注意，之前加密的数据若使用自定义配置，必须用原配置才能解密。

Q：可以加密超大文件（如几GB的视频）吗？
A：本系统采用流式处理，理论上可加密任意大小文件，但加密速度受限于混沌序列生成速度。对于超大文件，建议分块加密或使用更快的对称加密（如AES）配合本系统封装密钥。
